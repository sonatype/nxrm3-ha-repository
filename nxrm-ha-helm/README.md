<!--

    Sonatype Nexus (TM) Open Source Version
    Copyright (c) 2008-present Sonatype, Inc.
    All rights reserved. Includes the third-party code listed at http://links.sonatype.com/products/nexus/oss/attributions.

    This program and the accompanying materials are made available under the terms of the Eclipse Public License Version 1.0,
    which accompanies this distribution and is available at http://www.eclipse.org/legal/epl-v10.html.

    Sonatype Nexus (TM) Professional Version is available from Sonatype, Inc. "Sonatype" and "Sonatype Nexus" are trademarks
    of Sonatype, Inc. Apache Maven is a trademark of the Apache Software Foundation. M2eclipse is a trademark of the
    Eclipse Foundation. All other trademarks are the property of their respective owners.

-->

# Helm Chart for a High-Availability Nexus Repository Deployment

This Helm chart configures the Kubernetes resources that are needed for a high-availability (HA) Nexus Repository deployment on AWS/Azure/Onprem.

---

# Pre-requisites

### Storage
The default configuration uses an emptyDir volume for storing Nexus Repository logs. However, this is only for demonstration purposes. For production, we strongly recommend that
you configure dynamic provisioning of persistent storage or attach dedicated local disks based on your deployment environment as explained below.

#### Cloud deployments (AWS/Azure)
* Ensure the appropriate Container Storage Interface (CSI) driver(s) are installed on the Kubernetes cluster for your chosen cloud deployment. Please refer to AWS EKS/Azure AKS documentation for details on configuring CSI drivers.

#### On-premises deployments
1. Attach separate disks (i.e., separate from the root disk) to your worker nodes.
2. Install the Local Persistence Volume Static Provisioner. Please refer to [Local Persistence Volume Static Provisioner](https://github.com/kubernetes-sigs/sig-storage-local-static-provisioner) documentation.
3. Use the Local Persistence Volume Static Provisioner to automatically create persistent volumes for your chosen storage class name as [documented](https://github.com/kubernetes-sigs/sig-storage-local-static-provisioner)

#### Configuring for dynamic persistent volume provisioning
* Set the `storageClass.name` parameter to a storage class name. This could be one of the default storage classes automatically created in your managed Kubernetes cluster on your chosen cloud (e.g., if you're using AWS EKS) or one that you would like to create.
   * If you would like to create a dedicated storage class (i.e., you don't want to use the default), then in addition to specifying a value for `storageClass.name`, you must also set `storageClass.enabled` parameter to `true`.
   * Set the `nexusData.volumeClaimTemplate.enabled` parameter to `true`.
   * Set the `storageClass.provisioner` (e.g., for AWS EBS, you would use `ebs.csi.aws.com`).

## Format Limitations
HA supports all formats that PostgreSQL supports.


## Deployment Configuration

### AWS
* Set `aws.enabled` to `true`.

#### Storage:
* Set `pvc.volumeClaimTemplate.enabled` to `true`.
* Set `storageClass.name` to the name of the storage class to use for dynamic volume provisioning.
   * If you're running on Cloud and would like to use an in-built storage class, set this to the name of that storage class (e.g., for AWS, you might use `gp2`).
   * Alternatively, if you would like to create your own storage class, then do the following:
      * Specify values for the [storageclass.yaml](nxrm-ha-helm%2Ftemplates%2Fstorageclass.yaml) file.
      * Enable it by setting `storageClass.enabled` to `true`.

#### Secrets
AWS Secret Manager is disabled by default. If you would like to store your database secrets and license in AWS Secrets Manager, do as follows:
* Set `aws.secretmanager.enabled` to `true`.
   * Database credentials:
      * Store database credentials (i.e., host, user and password) in AWS secret manager.
      * In your values.yaml, do the following:
         * Set the keys and aliases to use for getting the database credentials from secrets manager:  
           `db:
           user: username
           userAlias: nxrm-db-user
           password: password
           passwordAlias: nxrm-db-password
           host: host
           hostAlias: nxrm-db-host`
            * Update the `secret.aws.rds.arn` to your Secret Manager ARN containing database credentials.
   * Initial Nexus Repository Admin Password
      * Store initial Nexus repository Admin password in AWS Secrets Manager.
      * Set the `secret.nexusAdmin.name` to the key you used in Secrets Manager.
      * Set the `secret.nexusAdmin.alias` to the alias you would like the helm chart to use.
      * Update the `secret.aws.adminpassword.arn` to your Secret Manager ARN containing initial admin password.
   * License
      * Store your Nexus Repository Pro license in AWS Secrets Manager.
      * Update the `secret.aws.license.arn` to your Secret Manager ARN containing your Nexus Repository Pro license.


### Azure
* Set `azure.enabled` to `true`.

#### Storage:
* Set `pvc.volumeClaimTemplate.enabled` to `true`.
* Set `storageClass.name` to the name of the storage class to use for dynamic volume provisioning.
   * If you're running on cloud and would like to use an in-built storage class, set this to the name of that storage class (e.g., for Azure, you might use `managed-csi`).
   * Alternatively, if you would like to create your own storage class, then do the following:
      * Specify values for the [storageclass.yaml](nxrm-ha-helm%2Ftemplates%2Fstorageclass.yaml) file.
      * Enable it by setting `storageClass.enabled` to `true`.

#### Secrets
Azure Key Vault is disabled by default. If you would like to store your database secrets and license in Azure Key Vault, do as follows:
* Set `azure.keyvault.enabled` to `true`.
   * Database credentials
      * Store database credentials (i.e., host, user, and password) in Azure Key Vault.
      * In your values.yaml, do the following:
         * Set the keys to use for getting the database credentials from Azure Key Vault:  
           `db:
           user: username
           password: password
           host: host`
         * Set the parameters nested in `secret.azure` accordingly.
   * Initial Nexus Repository Admin Password
      * Store initial Nexus repository Admin password in Azure Key Vault.
      * Set the `secret.nexusAdmin.name` to the key you used in Azure Key Vault.
   * License
      * Store your Nexus Repository Pro license in Azure Key Vault.
      * Set the `secret.license.name` to Azure Key Vault secret containing your Nexus Repository Pro license.

### On-premises
The chart doesn't install any cloud-specific resources when `aws.enabled` and `azure.enabled` are set to `false`.

#### Storage:
* Attach dedicated disks to your Kubernetes worker nodes.
* Install the Local Persistence Volume Static Provisioner and configure it to automatically create persistent volumes for your chosen storage class name as documented [here](https://github.com/kubernetes-sigs/sig-storage-local-static-provisioner).

#### Secrets
* Database credentials
   * Set `secret.dbSecret.enabled` to `true` to enable [database-secret.yaml](nxrm-ha-helm%2Ftemplates%2Fdatabase-secret.yaml) for storing database secrets.
   * Specify values for [database-secret.yaml](nxrm-ha-helm%2Ftemplates%2Fdatabase-secret.yaml).
* Initial Nexus Repository Admin Password
   * Set `secret.nexusAdminSecret.enabled` to `true` to enable [nexus-admin-secret.yaml](nxrm-ha-helm%2Ftemplates%2Fnexus-admin-secret.yaml) for storing initial Nexus Repository admin password secret.
   * Specify values for [nexus-admin-secret.yaml](nxrm-ha-helm%2Ftemplates%2Fnexus-admin-secret.yaml).
* License
   * Set the `secret.license.licenseSecret.enabled` to `true` to enable [license-config-mapping.yaml](nxrm-ha-helm%2Ftemplates%2Flicense-config-mapping.yaml) for storing your Nexus Repository Pro license.
   * Specify values for [license-config-mapping.yaml](nxrm-ha-helm%2Ftemplates%2Flicense-config-mapping.yaml).



## Installing this Chart
You can install this helm chart from the git repository or sonatype helm index.

### From git repository
1. Check out this git repository.

2. Enter your custom values in the supplied values.yaml.  

3. Install this chart using the following:
  
```helm install nxrm nxrm3-ha-repository/nxrm-ha-helm -f values.yaml```
  
4. Get the Nexus Repository link using the following:
  
```kubectl get ingresses -n nexusrepo```

### From Sonatype Helm index

1. Add the sonatype repo to your helm:

   ```helm repo add sonatype https://sonatype.github.io/helm3-charts/ ```

2. Enter your custom values in the supplied values.yaml.
3. Install this chart using the following:
```helm install nxrm nxrm3-ha-repository/nxrm-ha-helm -f values.yaml```
4. Get the Nexus Repository link using the following:
```kubectl get ingresses -n nexusrepo```
---

## Health Check
You can use the following commands to perform various health checks:
  
See a list of releases:
  
  ```helm list```
  
 Check pods using the following:
  
  ```kubectl get pods -n nexusrepo```
  
Check the Nexus Repository logs with the following:
  
  ```kubectl logs <pod_name> -n nexusrepo nxrm-app```

---

## Uninstall
To uninstall the deployment, use the following:
  
  ```helm uninstall nxrm```
  
After removing the deployment, ensure that the namespace is deleted and that Nexus Repository is not listed when using the following:
  
  ```helm list```


## Configuration

The following table lists the configurable parameters of the Nexus chart and their default values.

| Parameter                                                   | Description                                                                                                                                                                                                                                                                                                                                                                      | Default                                          |
|-------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
| `namespaces.nexusNs`                                        | The namespace into which Kubernetes resources for Nexus Repository are installed into                                                                                                                                                                                                                                                                                            | `nexusrepo`                                      |
| `namespaces.cloudwatchNs`                                   | The namespace into which Kubernetes resources for fluentbit are installed when fluentbit is enabled                                                                                                                                                                                                                                                                              | `amazon-cloudwatch`                              |
| `namespaces.externaldnsNs`                                  | The namespace into which Kubernetes resources for externaldns are installed when externaldns is enabled                                                                                                                                                                                                                                                                          | `nexus-externaldns`                              |
| `azure.enabled`                                             | Set this to true when installing this chart on Azure                                                                                                                                                                                                                                                                                                                             | `false`                                          |
| `azure.keyvault.enabled`                                    | Set this to true when installing this chart on Azure and you would like the Nexus Repository pod to pull database credentials and license from azure Key Vault                                                                                                                                                                                                                   | `false`                                          |
| `aws.enabled`                                               | Set this to true when installing this chart on AWS                                                                                                                                                                                                                                                                                                                               | `false`                                          |
| `aws.clusterRegion`                                         | The AWS region containing your Kubernetes cluster.                                                                                                                                                                                                                                                                                                                               | `us-east-1`                                      |
| `aws.secretmanager.enabled`                                 | Set this to true when installing this chart on AWS and you would like the Nexus Repository pod to pull database credentials and license from AWS Secret Manager                                                                                                                                                                                                                  | `false`                                          |
| `aws.externaldns.enabled`                                   | Set this to true when installing this chart on AWS and you would like to setup [externaldns](https://github.com/kubernetes-sigs/external-dns)                                                                                                                                                                                                                                    | `false`                                          |
| `aws.externaldns.domainFilter`                              | Domain filter for [externaldns](https://github.com/kubernetes-sigs/external-dns)                                                                                                                                                                                                                                                                                                 | `example.com`                                    |
| `aws.externaldns.awsZoneType`                               | The hosted zone type. See [externaldns](https://github.com/kubernetes-sigs/external-dns)                                                                                                                                                                                                                                                                                         | `private`                                        |
| `aws.fluentbit.enabled`                                     | Set this to true when installing this chart on AWS and you would like to install Fluentbit so that Nexus Repository logs can be sent to AWS Cloud Watch                                                                                                                                                                                                                          | `false`                                          |
| `aws.fluentbit.fluentbitVersion`                            | The fluentbit version                                                                                                                                                                                                                                                                                                                                                            | `2.28.0`                                         |
| `aws.fluentbit.clusterName`                                 | The name of your Kubernetes cluster. This is required by fluentbit                                                                                                                                                                                                                                                                                                               | `nxrm-nexus`                                     |
| `aws.serviceAccount.name`                                   | The name of a Kubernetes Service Account object to create in order for Nexus Repository to access AWS resources as needed                                                                                                                                                                                                                                                        | `nexus-repository-deployment-sa`                 |
| `aws.serviceAccount.role`                                   | The Amazon Resource Name (ARN) of an AWS IAM role to assign to the `aws.serviceAccount.name` Kubernetes Service Account object.                                                                                                                                                                                                                                                  | `arn:aws:iam::000000000000:role/nxrm-nexus-role` |
| `aws.serviceAccount.externaldns.name`                       | The name of a Kubernetes Service Account object to create in order for externaldns to access AWS resources as needed                                                                                                                                                                                                                                                             | `external-dns`                                   |
| `aws.serviceAccount.externaldns.role`                       | The Amazon Resource Name (ARN) of an AWS IAM role to assign to the `aws.serviceAccount.externaldns.name` Kubernetes Service Account object.                                                                                                                                                                                                                                      | `false`                                          |
| `statefulset.name`                                          | The suffix for the statefulset's name                                                                                                                                                                                                                                                                                                                                            | nexusrepo-statefulset                            |
| `statefulset.serviceName`                                   | The statefulset's service name                                                                                                                                                                                                                                                                                                                                                   | nexusrepo-statefulset                            |
| `statefulset.replicaCount`                                  | The desired number of Nexus Repository pods                                                                                                                                                                                                                                                                                                                                      | 3                                                |
| `statefulset.initContainer.image.repository`                | Image registry URL for an init container                                                                                                                                                                                                                                                                                                                                         | busybox                                          |
| `statefulset.initContainer.image.tag`                       | Image tag for an init container                                                                                                                                                                                                                                                                                                                                                  | 1.33.1                                           |
| `statefulset.initContainer.resources.requests.cpu`          | The minimum cpu the init container can request                                                                                                                                                                                                                                                                                                                                   | 0.1                                              |
| `statefulset.initContainer.resources.requests.memory`       | The minimum memory the init container can request                                                                                                                                                                                                                                                                                                                                | 256Mi                                            |
| `statefulset.initContainer.resources.limits.cpu`            | The maximum cpu the init container may get.                                                                                                                                                                                                                                                                                                                                      | 0.2                                              |
| `statefulset.initContainer.resources.limits.memory`         | The maximum memory the init container may get.                                                                                                                                                                                                                                                                                                                                   | 512Mi                                            |
| `statefulset.container.image.repository`                    | The Nexus repository image registry URL                                                                                                                                                                                                                                                                                                                                          | sonatype/nexus3                                  |
| `statefulset.container.image.tag`                           | The Nexus repository image tag                                                                                                                                                                                                                                                                                                                                                   | latest                                           |
| `statefulset.container.resources.requests.cpu`              | The minimum cpu the Nexus repository pod can request                                                                                                                                                                                                                                                                                                                             | 4                                                |
| `statefulset.container.resources.requests.memory`           | The minimum memory the Nexus repository pod can request                                                                                                                                                                                                                                                                                                                          | 8Gi                                              |
| `statefulset.container.resources.limits.cpu`                | The maximum cpu the Nexus repository pod may get.                                                                                                                                                                                                                                                                                                                                | 4                                                |
| `statefulset.container.resources.limits.memory`             | The maximum memory the Nexus repository pod may get.                                                                                                                                                                                                                                                                                                                             | 8Gi                                              |
| `statefulset.container.containerPort`                       | The Nexus Repository container's HTTP port                                                                                                                                                                                                                                                                                                                                       | 8081                                             |
| `statefulset.container.pullPolicy`                          | The Nexus Repository docker image pull policy                                                                                                                                                                                                                                                                                                                                    | IfNotPresent                                     |
| `statefulset.container.terminationGracePeriod`              | The time given for the pod to gracefully shut down                                                                                                                                                                                                                                                                                                                               | 120 seconds                                      |
| `statefulset.container.env.nexusDBName`                     | The name of the PostgreSQL database to use.                                                                                                                                                                                                                                                                                                                                      | nexus                                            |
| `statefulset.container.env.nexusDBPort`                     | The database port of the PostgreSQL database to use.                                                                                                                                                                                                                                                                                                                             | 5432                                             |
| `statefulset.container.env.install4jAddVmParams`            | Xmx and Xms settings for JVM                                                                                                                                                                                                                                                                                                                                                     | -Xms2703m -Xmx2703m                              |
| `statefulset.container.env.jdbcUrlParams`                   | Additional parameters to append to the database url. Expected format is  `"?foo=bar&baz=foo"`                                                                                                                                                                                                                                                                                    | null                                             |
| `statefulset.requestLogContainer.image.repository`          | Image registry URL for a container which tails Nexus Repository's request log                                                                                                                                                                                                                                                                                                    | busybox                                          |
| `statefulset.requestLogContainer.image.tag`                 | Image tagfor a container which tails Nexus Repository's request log                                                                                                                                                                                                                                                                                                              | 1.33.1                                           |
| `statefulset.requestLogContainer.resources.requests.cpu`    | The minimum cpu the request log container can request                                                                                                                                                                                                                                                                                                                            | 0.1                                              |
| `statefulset.requestLogContainer.resources.requests.memory` | The minimum memory the request log container can request                                                                                                                                                                                                                                                                                                                         | 256Mi                                            |
| `statefulset.requestLogContainer.resources.limits.cpu`      | The maximum cpu the request log container may get.                                                                                                                                                                                                                                                                                                                               | 0.2                                              |
| `statefulset.requestLogContainer.resources.limits.memory`   | The maximum memory the request log container may get.                                                                                                                                                                                                                                                                                                                            | 512Mi                                            |
| `statefulset.auditLogContainer.image.repository`            | Image registry URL for a container which tails Nexus Repository's audit log                                                                                                                                                                                                                                                                                                      | busybox                                          |
| `statefulset.auditLogContainer.image.tag`                   | Image tagfor a container which tails Nexus Repository's audit log                                                                                                                                                                                                                                                                                                                | 1.33.1                                           |
| `statefulset.auditLogContainer.resources.requests.cpu`      | The minimum cpu the audit log container can request                                                                                                                                                                                                                                                                                                                              | 0.1                                              |
| `statefulset.auditLogContainer.resources.requests.memory`   | The minimum memory the audit log container can request                                                                                                                                                                                                                                                                                                                           | 256Mi                                            |
| `statefulset.auditLogContainer.resources.limits.cpu`        | The maximum cpu the audit log container may get.                                                                                                                                                                                                                                                                                                                                 | 0.2                                              |
| `statefulset.auditLogContainer.resources.limits.memory`     | The maximum memory the reauditquest log container may get.                                                                                                                                                                                                                                                                                                                       | 512Mi                                            |
| `statefulset.taskLogContainer.image.repository`             | Image registry URL for a container which aggregates and tails Nexus Repository's task log                                                                                                                                                                                                                                                                                        | busybox                                          |
| `statefulset.taskLogContainer.image.tag`                    | Image tag for a container which aggregates and tails Nexus Repository's task log                                                                                                                                                                                                                                                                                                 | 1.33.1                                           |
| `statefulset.taskLogContainer.resources.requests.cpu`       | The minimum cpu the task log container can request                                                                                                                                                                                                                                                                                                                               | 0.1                                              |
| `statefulset.taskLogContainer.resources.requests.memory`    | The minimum memory the task log container can request                                                                                                                                                                                                                                                                                                                            | 256Mi                                            |
| `statefulset.taskLogContainer.resources.limits.cpu`         | The maximum cpu the task log container may get.                                                                                                                                                                                                                                                                                                                                  | 0.2                                              |
| `statefulset.taskLogContainer.resources.limits.memory`      | The maximum memory the task log container may get.                                                                                                                                                                                                                                                                                                                               | 512Mi                                            |
| `statefulset.livenessProbe.initialDelaySeconds`             | LivenessProbe initial delay                                                                                                                                                                                                                                                                                                                                                      | 30                                               |
| `statefulset.livenessProbe.periodSeconds`                   | Seconds between polls                                                                                                                                                                                                                                                                                                                                                            | 30                                               |
| `statefulset.livenessProbe.failureThreshold`                | Number of attempts before failure                                                                                                                                                                                                                                                                                                                                                | 6                                                |
| `statefulset.livenessProbe.timeoutSeconds`                  | Time in seconds after liveness probe times out                                                                                                                                                                                                                                                                                                                                   | `nil`                                            |
| `statefulset.livenessProbe.path`                            | Path for LivenessProbe                                                                                                                                                                                                                                                                                                                                                           | /                                                |
| `statefulset.readinessProbe.initialDelaySeconds`            | ReadinessProbe initial delay                                                                                                                                                                                                                                                                                                                                                     | 30                                               |
| `statefulset.readinessProbe.periodSeconds`                  | Seconds between polls                                                                                                                                                                                                                                                                                                                                                            | 30                                               |
| `statefulset.readinessProbe.failureThreshold`               | Number of attempts before failure                                                                                                                                                                                                                                                                                                                                                | 6                                                |
| `statefulset.readinessProbe.timeoutSeconds`                 | Time in seconds after readiness probe times out                                                                                                                                                                                                                                                                                                                                  | `nil`                                            |
| `statefulset.readinessProbe.path`                           | Path for ReadinessProbe                                                                                                                                                                                                                                                                                                                                                          | /                                                |
| `statefulset.imagePullSecrets`                              | The pull secret for private image registries                                                                                                                                                                                                                                                                                                                                     | `{}`                                             |
| `ingress.name`                                              | The name of an Ingress object which listens for requests to Nexus Repository on port 80                                                                                                                                                                                                                                                                                          | nexus-ingress                                    |
| `ingress.enabled`                                           | Whether or not to create the Ingress                                                                                                                                                                                                                                                                                                                                             | false                                            |
| `ingress.host`                                              | Ingress host                                                                                                                                                                                                                                                                                                                                                                     | `null`                                           |
| `ingress.dockerSubdomain`                                   | Whether or not to add rules for docker subdomains                                                                                                                                                                                                                                                                                                                                | `false`                                          |
| `ingress.defaultRule`                                       | Whether or not to add a default rule for the Nexus Repository Ingress which forwards traffic to a Service object                                                                                                                                                                                                                                                                 | `false`                                          |
| `ingress.additionalRules`                                   | Additional rules to add to the ingress                                                                                                                                                                                                                                                                                                                                           | `null`                                           |
| `ingress.incressClassName`                                  | The ingress class name e.g., nginx, alb etc.                                                                                                                                                                                                                                                                                                                                     | `null`                                           |
| `ingress.tls.enabled`                                       | Whether or not TLS should be enabled for the Ingress                                                                                                                                                                                                                                                                                                                             | `false`                                          |
| `ingress.tls.secretName`                                    | The name of a Secret object in which to store the TLS secret                                                                                                                                                                                                                                                                                                                     | tlsSecretName                                    |
| `ingress.annotations`                                       | Annotations for the Ingress object                                                                                                                                                                                                                                                                                                                                               | `nil`                                            |
| `ingress.dockerIngress.name`                                | The name of an Ingress object which listens for requests to an existing docker repository in Nexus Repository                                                                                                                                                                                                                                                                    | `docker-ingress`                                 |
| `ingress.dockerIngress.enabled`                             | Whether or not to create an Ingress for a docker repository                                                                                                                                                                                                                                                                                                                      | `false`                                          |
| `ingress.dockerIngress.annotations`                         | Annotations for the docker Ingress object                                                                                                                                                                                                                                                                                                                                        | `nil`                                            |
| `storageClass.enabled`                                      | Set to true if you'd like to create your own storage class for persistent volumes and persistent volume claims                                                                                                                                                                                                                                                                   | `false`                                          |
| `storageClass.name`                                         | The name of a storage class object to create                                                                                                                                                                                                                                                                                                                                     | `nexus-storage`                                  |
| `storageClass.provisioner`                                  | The name of a storage class provisioner                                                                                                                                                                                                                                                                                                                                          | `provisionerName`                                |
| `storageClass.volumeBindingMode`                            | The volume binding mode for the storage class                                                                                                                                                                                                                                                                                                                                    | `WaitForFirstConsumer`                           |
| `storageClass.reclaimPolicy`                                | The reclaim policy for any volumes which use this storage class                                                                                                                                                                                                                                                                                                                  | `Retain`                                         |
| `storageClass.parameters`                                   | Volume parameters for the storage class                                                                                                                                                                                                                                                                                                                                          | `nil`                                            |
| `pvc.accessMode`                                            | The persistent volume claim access mode                                                                                                                                                                                                                                                                                                                                          | ReadWriteOnce                                    |
| `pvc.storage`                                               | The volume size to request for storing Nexus logs                                                                                                                                                                                                                                                                                                                                | 2Gi                                              |
| `pvc.volumeClaimTemplate.enabled`                           | You should set this property to true for cloud deployments in order to use dynamic volume provisioning to reserve volumes for Nexus Repository's logs. For on-premises deployment use [Local Persistence Volumen Static Provisioner](https://github.com/kubernetes-sigs/sig-storage-local-static-provisioner) to automatically create persistent volumes for pre-attached disks. | `false`                                          |
| `service.nexus.enabled`                                     | Whether or not to create the Service object                                                                                                                                                                                                                                                                                                                                      | `false`                                          |
| `service.nexus.name`                                        | The name of a kubernetes Service Object which allows access to Nexus Repository's main HTTP port                                                                                                                                                                                                                                                                                 | nexus-service                                    |
| `service.nexus.type`                                        | The type of the Kubernetes Service                                                                                                                                                                                                                                                                                                                                               | "NodePort"                                       |
| `service.nexus.protocol`                                    | The protocol                                                                                                                                                                                                                                                                                                                                                                     | TCP                                              |
| `service.nexus.port`                                        | The port to listen for incoming requests                                                                                                                                                                                                                                                                                                                                         | `80`                                             |
| `service.nexus.targetPort`                                  | The port to forward requests to                                                                                                                                                                                                                                                                                                                                                  | `8081`                                           |
| `service.docker.name`                                       | The name of a kubernetes Service Object which allows access to a docker repository within Nexus Repository                                                                                                                                                                                                                                                                       | nexus-docker-service                             |
| `service.docker.enabled`                                    | Whether or not to create a Kubernetes Service object for a given docker repository within Nexus Repository                                                                                                                                                                                                                                                                       | `false`                                          |
| `service.docker.type`                                       | The type of the Kubernetes Service                                                                                                                                                                                                                                                                                                                                               | "NodePort"                                       |
| `service.docker.protocol`                                   | The protocol                                                                                                                                                                                                                                                                                                                                                                     | TCP                                              |
| `service.docker.port`                                       | The port to listen for incoming requests                                                                                                                                                                                                                                                                                                                                         | 9090                                             |
| `service.docker.targetPort`                                 | The port to forward requests to                                                                                                                                                                                                                                                                                                                                                  | 8081                                             |
| `nexusData.volumeClaimTemplate.enabled`                     | Whether or not volume should be requested using a claim template. You should set this property to true when using dynamic volume provisioning (cloud deployments) or if you're using Local Storage Operator to automatically create persistent volumes for locally attached disks (i.e. not root disk)                                                                           | false                                            |
| `secret.secretProviderClass`                                | The secret provider class for Kubernetes secret store object. See [secret.yaml](templates%2Fsecret.yaml). Set this when using AWS Secret Manager or Azure Key Vault                                                                                                                                                                                                              | secretProviderClass                              |
| `secret.provider`                                           | The provider (e.g. azure, aws etc) for Kubernetes secret store object. Set this when using AWS Secret Manager or Azure Key Vault                                                                                                                                                                                                                                                 | provider                                         |
| `secret.dbSecret.enabled`                                   | Whether or not to install [database-secret.yaml](templates%2Fdatabase-secret.yaml). Set this to `false` when using AWS Secret Manager or Azure Key Vault                                                                                                                                                                                                                         | `false`                                          |
| `secret.dbSecret.name`                                      | The name for [secret.yaml](templates%2Fsecret.yaml)                                                                                                                                                                                                                                                                                                                              | nxrm-db-secret                                   |
| `secret.db.user`                                            | The key for secret in AWS Secret manager or Azure Key Vault which contains the database user name. Otherwise if `secret.dbSecret.enabled` is true, set this to the database user name.                                                                                                                                                                                           | nxrm-db-user                                     |
| `secret.db.user-alias`                                      | Applicable to AWS Secret Manager only. An alias to use for the database user secret retrieved from AWS Secret manager.                                                                                                                                                                                                                                                           | nxrm-db-user-alias                               |
| `secret.db.password`                                        | The key for secret in AWS Secret manager or Azure Key Vault which contains the database password. Otherwise if `secret.dbSecret.enabled` is true, set this to the database password.                                                                                                                                                                                             | nxrm-db-password                                 |
| `secret.db.password-alias`                                  | Applicable to AWS Secret Manager only. An alias to use for the database password secret retrieved from AWS Secret manager.                                                                                                                                                                                                                                                       | nxrm-db-password-alias                           |
| `secret.db.host`                                            | The key for secret in AWS Secret manager or Azure Key Vault which contains the database host URL. Otherwise if `secret.dbSecret.enabled` is true, set this to the database host URL.                                                                                                                                                                                             | nxrm-db-host                                     |
| `secret.db.host-alias`                                      | Applicable to AWS Secret Manager only. An alias to use for the database host secret retrieved from AWS Secret manager.                                                                                                                                                                                                                                                           | nxrm-db-host-alias                               |
| `secret.nexusAdminSecret.enabled`                           | Whether or not to install [nexus-admin-secret.yaml](templates%2Fnexus-admin-secret.yaml). Set this to `false` when using AWS Secret Manager or Azure Key Vault.                                                                                                                                                                                                                  | `false`                                          |
| `secret.nexusAdminSecret.adminPassword`                     | When `secret.nexusAdminSecret.enabled` is true, set this to the initial admin password for Nexus Repository.  Otherwise ignore.                                                                                                                                                                                                                                                  | yourinitialnexuspassword                         |
| `secret.nexusAdmin.name`                                    | The key for secret in AWS Secret manager or Azure Key Vault which contains the initial Nexus Repository admin password. Otherwise if `secret.nexusAdminSecret.enabled` is true, then set this to the name for [nexus-admin-secret.yaml](templates%2Fnexus-admin-secret.yaml)                                                                                                     | `nexusAdminPassword`                             |
| `secret.nexusAdmin.alias`                                   | Applicable to AWS Secret Manager only. An alias to use for the initial Nexus Repository admin password secret retrieved from AWS Secret manager.                                                                                                                                                                                                                                 | `admin-nxrm-password-alias`                      |
| `secret.license.name`                                       | The name for [license-config-mapping.yaml](templates%2Flicense-config-mapping.yaml) for storing Nexus Repository license. This is an alternative way of specifying your Nexus Repository Pro license. Use this option when not using Azure Key Vault or AWS Secret Manager                                                                                                       | nexus-repo-license.lic                           |
| `secret.license.licenseSecret.enabled`                      | Whether or not to install [license-config-mapping.yaml](templates%2Flicense-config-mapping.yaml)                                                                                                                                                                                                                                                                                 | `false`                                          |
| `secret.license.licenseSecret.fileContentsBase64`           | A base64 representation of your Nexus Repository Pro license                                                                                                                                                                                                                                                                                                                     | your_license_file_contents_in_base_64            |
| `secret.license.licenseSecret.mountPath`                    | The path where your Nexus Repository Pro license is mounted in the Nexus Repository container                                                                                                                                                                                                                                                                                    | /var/nexus-repo-license                          |
